{% raw %}
<div class="content bib"><form name="form" class="form-horizontal" data-ng-controller="EditCtrl">
  <header class="clearfix">
    <h1>JSON-LD</h1>
    <p>
      Den underliggande datastrukturen representerad som ett träd av entiteter, på formatet <a href="http://json-ld.org/" target="_blank">JSON-LD <i class="fa fa-external-link"></i></a>. Här visas all data som är lyft ur MARC-posten, samt de delar som ännu inte mappats (då placerade i fältet "unknown"). 
    </p>
    <p>
      Denna struktur är under utveckling. Kom gärna med synpunkter om något saknas eller ser feltolkat ut.
    </p>
    <div data-ng-include="'/partials/_mode_menu'" onload="mode = 'JSON-LD'"></div>
  </header>

  <section data-ng-repeat="object in [record]" class="json-ld"
      data-ng-include="'render-object'"></section>

</form></div>

<script type="text/ng-template" id="render-object">
  <div class="header" data-ng-if="object[TYPE] || object[ID]">
    <span class="type" data-ng-if="object[TYPE]"
          data-ng-repeat="typekey in ensureArray(object[TYPE])"
          data-ng-click="openTermDef(typekey)">{{ typekey }} </span>
    <span data-ng-if="object[ID]">
      <a href="{{ toJsonLdLink(object[ID]) }}">&lt;{{ object[ID] }}&gt; </a>
    </span>
  </div>
  <div data-ng-repeat="key in jsonLdKeys(object)"
       data-ng-init="obj = object[key]" data-ng-if="key[0] != '@'">
    <ng:switch on="typeOf(obj)">
      <div data-ng-switch-when="object"
           data-ng-init="collapsed = (key == 'unknown')"
           data-ng-class="{collapsed: collapsed, array: lodash.isArray(obj)}">
        <label class="entitylink">
          <span data-ng-click="openTermDef(key)">{{ key }}</span>
          <i data-ng-click="collapsed=!collapsed"> </i>
        </label>
        <section data-ng-init="object = obj"
            data-ng-include="'render-object'" class="entity"></section>
      </div>
      <span data-ng-switch-when="string">
        <code data-ng-click="openTermDef(key)">{{ key }}</code>
        <input data-ng-model="obj" type="text" />
      </span>
    </ng:switch>
  </div>
</script>

{% endraw %}
