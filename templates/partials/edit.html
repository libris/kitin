<div id="confirmDeleteDraftDialog" data-ng-show="confirmDeleteDraft" class="popover show">
  <div class="popover-inner">
    <button class="close" data-ng-click="confirmDeleteDraft.abort()">&times;</button></h3>
</div>

<div class="popover-content">
  <h4>Vill du verkligen ta bort utkastet?</h4>
  <button class="btn btn-success" data-ng-click="confirmDeleteDraft.execute()">Ja</button></h3>
<button class="btn btn-warning" data-ng-click="confirmDeleteDraft.abort()">Nej</button></h3>
  </div>
</div>

<div class="content bib" id="prelude"><form id="record" class="form-horizontal">
  <div id="grid"></div>
    <!--<div data-ng-view></div>-->
  <header>
    <h1>Bibliografisk post</h1>
    <div class="levels">
      <span>Monografisk resurs</span>
      <span>{{ enums.encLevel[record.encLevel || '_'].label_sv }}</span>
      <span>{{ enums.catForm[record.catForm || 'a'].label_sv }}</span>
    </div>
    <div class="modes">
      <a href="#" class="active">LIBRIS</a>
      <a href="#">MARC</a>
    </div>
  </header>
  <section id="work" data-ng-repeat="work in [record.about.instanceOf]">
    <h2>Verk<i></i></h2>
    <div class="cols">
      <div class="col6">
        <label>
          <textarea data-inplace class="title" data-ui-jq="autosize" spellcheck="false" placeholder="Skriv en titel" data-ng-model="work.title"></textarea>
          <span class="lbl">{{ "Huvudtitel" }}</span>
        </label>
        <label>
          <textarea data-inplace data-ui-jq="autosize" spellcheck="false" placeholder="Skriv en undertitel" data-ng-model="work.titleRemainder">{{ work.titleRemainder }}</textarea>
          <span class="lbl">{{ "Övrigt titelinformation" }}</span>
        </label>
        <label class="ng-binding">
          <!--<span class="fakeholder" data-fakeholder>Välj ett land</span>
          <select class="selectpicker" data-selectpicker data-ng-model="work.language" data-ng-options="code as name for (code, name) in langlist">
          </select>-->
          <select class="selectpicker" data-placeholder="Välj ett språk" data-ui-select2 data-ng-model="work.language" style="width:75%">
             <option></option>
             <option data-ng-repeat="(code, name) in langlist" value="{{ code }}">{{ name }} ({{ code }})</option>
         </select>
         <!--<pre>Selected: {{ work.language | json }}</pre>
         <input data-inplace ui-select2="langlist" ng-model="work.language" style="width:200px" />-->
          <span class="lbl">{{ "Språk" }}</span>
        </label>
      </div>
      <div class="col6">
        <label class="error">
          <textarea data-inplace data-ui-jq="autosize" spellcheck="false" data-ng-model="work.statementOfResponsibility" placeholder="Upphov"></textarea>
          <span class="lbl">{{ "Upphov" }}</span>
        </label>
        <div data-ng-repeat="person in work.authorList" class="entity person">
          <label>
            <input data-inplace class="input" type="text" data-kitin-autocomplete="field" data-kitin-template="auth-completion-template" data-ng-model="person.authoritativeName" />
            <span class="lbl">{{ "Personnamn" }}</span>
          </label>
          <div class="addon">
            <label>
              <input data-inplace class="input-mini authdependant" type="text" placeholder="yyyy" data-ng-model="person.birthYear" />
              <span class="lbl">{{ "Född" }}</span>
            </label>
            <label>
              <input data-inplace class="input-mini authdependant" type="text" placeholder="yyyy" data-ng-model="person.deathYear" />
              <span class="lbl">{{ "Död" }}</span>
            </label>
          </div>
          <button class="btn-link" data-ng-click="remove_person($index)"><i class="ficon ficon-remove"></i> Ta bort upphovsman</button>
        </div>
        <button class="btn-link" data-ng-click="add_person(work, 'authorList')"><i class="ficon ficon-plus-sign"></i> upphovsman</button>
      </div>
    </div>
    <div class="foot">
      <button class="btn btn-libris">Lägg till <i class="icon icon-white icon-chevron-down"></i></button>
    </div>
  </section>
  <section id="classification" data-ng-repeat="work in [record.about.instanceOf]">
    <div class="cols">
      <div class="col6">
        <h3>Ämnesord</h3>
        <label class="dynamic-subjects">
          <span class="subjects" data-ng-repeat="subject in work.subjectList">
            <em class="subject">{{subject.term}}
              <span data-ng-show="subject.formSubdivision">&mdash; {{subject.formSubdivision}}</span>
              <span data-ng-show="subject.geographicSubdivision">&mdash; {{subject.geographicSubdivision}}</span>
              <span data-ng-show="subject.system">({{subject.system}})</span>
              <i class="ficon ficon-circle-arrow-down"></i></em>
          </span>
            <span class="lbl">Ämnesord</span>
        </label>
        <label class="add-subject">
          <textarea data-inplace placeholder="Lägg till ämnesord" disabled></textarea>
          <span class="lbl">Skriv in ämnesord</span>
        </label>
        <!--
        <div class="suggestion-subjects">
          <ul>
            <li><i class="ficon ficon-circle-arrow-up"></i>...</li>
          </ul>
        </div>
        -->
          <!--<ul class="inline">
            <li data-ng-repeat="topic in work.subject"><a class="btn btn-small" href="{{ topic['@id'] }}"><i class="icon-tag"></i> {{ topic['@id'] }}</a></li>
          </ul>-->
      </div>
      <div class="col6">
        <h3>Klassifikation</h3>
        <!--
        <ul class="inline">
        <li data-ng-repeat="topicalTerm in record.topicalTerm"><a class="btn btn-small" href="{{ topicalTerm }}"><i class="icon-tag"></i> {{ topicalTerm }}</a></li>
      </ul>
          -->
        <label class="dynamic-subjects">
          <span class="subjects" data-ng-repeat="classification in work['class-ddc']">
            <em class="subject">{{classification}}
              <i class="ficon ficon-circle-arrow-down"></i></em>
          </span>
          <span class="lbl">Klassifikation</span>
        </label>
        <label class="add-subject">
          <textarea data-inplace placeholder="Lägg till klassifikation" disabled></textarea>
          <span class="lbl">Skriv in klassifikation</span>
        </label>
      </div>

    </div>
    <h3>{{ "Anmärkningar" }}</h3>
    <div class="cols">
      <div class="col6">
        <label>
          <textarea data-inplace data-ui-jq="autosize" spellcheck="false" data-ng-model="work.summary" placeholder="Sammanfattning"></textarea>
          <span class="lbl">{{ "Sammanfattning" }}</span>
        </label>
      </div>
    </div>
  </section>

  <section id="instance" data-ng-repeat="instance in [record.about]">
    <h2 data-ng-click="cycleType(instance)"> <span>{{ getTypeDef(instance).label_sv }}</span> (representation)<i></i></h2>
    <div class="cols">
      <div class="col6" data-ng-show="instance['@type'] != 'Book'">
        <label>
          <input data-inplace class="ng-pristine ng-valid" type="text" data-ng-model="instance.mediaTerm" placeholder="Allmän medieterm">
          <span class="lbl">{{ "Allmän medieterm" }}</span>
        </label>
      </div>
    </div>
    <div class="cols">
      <div class="col3">
        <label>
          <input data-inplace class="ng-pristine ng-valid" type="text" data-ng-model="instance.isbn" placeholder="ISBN" isbnvalidator>
          <span class="lbl">{{ "ISBN" }}</span>
        </label>
        <label data-ng-repeat="publisher in instance.publisher">
          <input data-inplace class="ng-pristine ng-valid" type="text" data-ng-model="publisher.name" placeholder="Utgivare förlag">
          <span class="lbl">{{ "Utgivare/förlag" }}</span>
        </label>
      </div>
      <div class="col3">
        <div class="split">
          <label>
            <input data-inplace class="ng-pristine ng-valid" type="text" data-ng-model="instance.isbnNote" placeholder="ISBN Notering">
            <span class="lbl">{{ "ISBN Notering" }}</span>
          </label>
          <label>
            <input data-inplace class="ng-pristine ng-valid" type="text" data-ng-model="instance.edition" placeholder="Upplaga">
            <span class="lbl">{{ "Upplaga" }}</span>
          </label>
        </div>
        <label>
          <input data-inplace class="ng-pristine ng-valid" type="text" data-ng-model="instance.placeOfPublication.label" placeholder="Utgivningsort">
          <span class="lbl">{{ "Utgivningsort" }}</span>
        </label>
        </label>
      </div>
      <div class="col6">
        <label>
          <select data-placeholder="Välj ett land" data-ui-select2 data-ng-model="record.about.instanceOf.country" style="width:75%">
             <option></option>
             <option data-ng-repeat="(code, name) in countrylist" value="{{ code }}">{{ name }} ({{ code }})</option>
         </select>
          <span class="lbl">{{ "Utgivningsland" }}</span>
        </label>
        <label>
          <select data-placeholder="Välj ett land" data-ui-select2 data-ng-model="instance.placeOfManufacture.label" style="width:75%">
             <option></option>
             <option data-ng-repeat="(code, name) in countrylist" value="{{ code }}">{{ name }} ({{ code }})</option>
         </select>
          <span class="lbl">{{ "Tryckland" }}</span>
        </label>
      </div>
      <div class="cols3" data-ng-show="getTypeDef(instance).term == 'Audiobook'">
        <label>
          <input data-inplace class="ng-pristine ng-valid" type="text" data-ng-model="instance.publisherNumber" placeholder="Utgivningsnummer">
          <span class="lbl">{{ "Utgivningsnummer" }}</span>
        </label>
      </div>
    </div>
    <!-- TODO: partially toggle digital details
    <div data-ng-show="getTypeDef(instance).subClassOf != 'DigitalResource'">
    -->
    <h3>Fysisk beskrivning</h3>
    <div class="cols">
      <div class="col3">
        <label class="ng-binding">
          <input data-inplace class="ng-pristine ng-valid" type="text" data-ng-model="instance.extent" placeholder="Omfång">
          <span class="lbl">{{ "Omfång" }}</span>
        </label>
      </div>
      <div class="col3">
        <label>
          <input data-inplace class="ng-pristine ng-valid" type="text" data-ng-model="instance.dimensions" placeholder="Mått">
          <span class="lbl">{{ "Mått" }}</span>
        </label>
      </div>
      <div class="col3">
        <label>
          <input data-inplace class="ng-pristine ng-valid" type="text" data-ng-model="instance.physicalDetails" placeholder="Fysiska detaljer">
          <span class="lbl">{{ "Fysiska detaljer" }}</span>
        </label>
      </div>
      <div class="col3">
        <label>
          <input data-inplace class="ng-pristine ng-valid" type="text" data-ng-model="instance.termsOfAvailability" placeholder="Pris">
          <span class="lbl">{{ "Pris" }}</span>
        </label>
      </div>
    </div>
    <div class="cols" data-ng-show="getTypeDef(instance).subClassOf == 'DigitalResource'">
      <div class="col3">
        <label>
          <input data-inplace class="ng-pristine ng-valid" type="text" data-ng-model="instance.fileType" placeholder="Filtyp">
          <span class="lbl">{{ "Filtyp" }}</span>
        </label>
      </div>
      <div class="col3">
        <label>
          <input data-inplace class="ng-pristine ng-valid" type="text" data-ng-model="instance.systemRequirements" placeholder="Systemkrav">
          <span class="lbl">{{ "Systemkrav" }}</span>
        </label>
      </div>
    </div>
  <h3>{{ "Anmärkningar" }}</h3>
    <div class="cols">
      <div class="col6">
        <label>
          <textarea data-inplace data-ui-jq="autosize" spellcheck="false" data-ng-model="instance.listOfContents" placeholder="Formaterad innehållsförteckning"></textarea>
          <span class="lbl">{{ "Formaterad innehållsförteckning" }}</span>
        </label>
      </div>
      <div class="cols6" data-ng-show="getTypeDef(instance).term == 'Audiobook'">
        <label>
          <input data-inplace class="ng-pristine ng-valid" type="text" data-ng-model="instance.contributorNote" placeholder="Medverkande">
          <span class="lbl">{{ "Medverkande" }}</span>
        </label>
      </div>
    </div>
  </section>

  <section class="submit">
<!--post beta:
    <span class="removedraft" data-ng-show="draft" data-ng-click="promptConfirmDelete($event, draft.type, draft.id)">
      <button class="btn-link" data-ng-click="somebutton.click()"><i class="ficon ficon-remove"></i> Ta bort utkast</button>
    </span>-->
    <button class="btn-link" id='btn2' data-ng-click="save_draft()">Spara utkast</button>
    <button class="btn btn-dark btn-submit" id='btn3' data-ng-click="save()">Publicera</button>
  </section>
</form></div>

<div class="content holdings" id="prelude">
  <div id="grid"></div>
    <!--<div data-ng-view></div>-->
  <header>
    <h1>Bestånd</h1>
  </header>
<!--remove when holdings are done
  <section id="holdings">
    <div class="cols holdings-editor">
      <div class="col3 holdings-list">
        <ul>
          <li><a href="#">A</a></li>
          <li class="active"><a href="#">B</a></li>
          <li><a href="#">C</a></li>
        </ul>
      </div>
      <div class="col9">
        <div class="editor">
        <h3>{{ "Förslag på signum" }}</h3>
          <div class="suggestion-classification">
          <ul>
            <li data-ng-repeat="holding in holdings" data-ng-show="holding.classificationPart"><i class="ficon ficon-circle-arrow-up"></i> {{ holding.classificationPart }}</li>
          </ul>
          </div>
        </div>
      </div>
    </div>
    <div class="foot">
      <button class="btn btn-purple">Lägg till <i class="icon icon-white icon-chevron-down"></i></button>
    </div>
  </section>-->
  <section class="holdings">
    <h2>Bestånd<i></i></h2>
    <h3 class="inline_heading">{{user_sigel}}</h3>
    <div class="cols">
      <div class="col6">
          <!--hidden input for setting sigel--><input data-inplace type="hidden" data-ng-model="holding.location" maxlength="4" value="{{user_sigel}}"/>
          <label>
          <input data-inplace type="text" placeholder="Avdelning/Samling" data-ng-model="holding.shelvingLocation"/>
          <span class="lbl">{{ "Avdelning/Samling" }}</span>
          </label>
		  <label>
          <input data-inplace type="text" placeholder="Hyllsignum/Klassifikation" data-ng-model="holding.classificationPart"/>
          <span class="lbl">{{ "Hyllsignum/Klassifikation" }}</span>
          </label>
          <div class="suggestion-classification">
          <ul>
            <li data-ng-repeat="holding in holdings" data-ng-show="holding.classificationPart"><i class="ficon ficon-circle-arrow-up"></i> {{ holding.classificationPart }}</li>
          </ul>
		  <span class="lbl lbl-suggest">Förslag på signum</span>
          </div>
       </div>
      <div class="col6">
          <label>
          <input data-inplace type="text" placeholder="Löpnummer" data-ng-model="holding.shelvingControlNumber"/>
          <span class="lbl">{{ "Löpnummer" }}</span>
          </label>
          <label>
          <input data-inplace type="text" placeholder="Uppställningsord" data-ng-model="holding.shelvingFormOrTitle"/>
          <span class="lbl">{{ "Uppställningsord" }}</span>
          </label>
          <label>
          <input data-inplace type="text" placeholder="Exemplarinfo" data-ng-model="holding.itemPart"/>
          <span class="lbl">{{ "Exemplarinfo" }}</span>
          </label>
          <label>
          <input data-inplace type="text" placeholder="Exemplarnummer" data-ng-model="holding.copyNumber"/>
          <span class="lbl">{{ "Exemplarnummer" }}</span>
          </label>
          <label>
          <textarea data-inplace data-ui-jq="autosize" spellcheck="false" placeholder="Publik anmärkning" data-ng-model="holding.shelvingPublicNote"></textarea>
          <span class="lbl">{{ "Publik anmärkning" }}</span>
          </label>
          <label>
          <textarea data-inplace data-ui-jq="autosize" spellcheck="false" placeholder="Intern anmärkning" data-ng-model="holding.shelvingNonpublicNote"></textarea>
          <span class="lbl">{{ "Intern anmärkning" }}</span>
          </label>
      </div>
    </div>
    <div class="foot">
      <!--not available in beta:<button disabled class="btn btn-purple" data-ng-click="add_holding(holdings)">Lägg till <i class="icon icon-white icon-chevron-down"></i></button>-->
    </div>
    </section>
	<section class="submit">
      <button class="btn btn-purple  btn-submit" id="save-hld" data-ng-click="save_holding(holding)">Spara bestånd</button>
      <button data-ng-show="holding['@id']"class="btn-link" id="delete-hld" data-ng-click="delete_holding(holding['@id'])">Ta bort</button>
    </section>
  <section class="holdings holdings-list">
    <h2>Allt Bestånd<i></i></h2>
    <div class="cols">
      <div class="col12">
          <div data-ng-repeat="holding in holdings" data-ng-include="'render-holding'">
          </div>
     </div>
    </div>
    </section>
  </div>
</div>
</form>


<script type="text/ng-template" id="render-holding">
<div class="holdings-list" data-ng-show="holding.location"> 
  <ul>
    <li data-ng-show="holding.location"><a href="{{ holding['@id'] }}" class="sigel">{{ holding.location }}<span class="pull-right"><i class="icon icon-black icon-chevron-down"></i></span></a></li>
  </ul>
</div>
</script>

<script type="text/html" id="auth-completion-template">
<div class="auth">
  <h4>
    <span class="name"><%= data['authoritativeName'] %></span>
    <span class="date"><%= data['birthYear'] %> - <%= data['deathYear'] %></span>
    <% if (data['authorized']) { %>
      <span class="what"><i class="ficon ficon-bookmark"></i>Aukt.</span>
    <% } %>
  </h4>
  <% if (data['hasAnnotation'] && data['hasAnnotation']['about']) { %>
    <ul class="about">
      <% if (Object.prototype.toString.call(data['hasAnnotation']['about']) === '[object Array]') { %> 
        <% data['hasAnnotation']['about'].forEach(function(item) { %>
          <li><%= item %></li>
        <% }); %>
      <% } else { %>
        <li><%= data['hasAnnotation']['about'] %></li>
      <% } %>
    </ul>
  <% } %>
</div>
</script>

