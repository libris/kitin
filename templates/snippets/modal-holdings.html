<div class="modal-header holdings">
  <button type="button" class="close" ng-click="close()" aria-hidden="true">&times;</button>
  <h4 class="modal-title"><span translate>LABEL.gui.terms.HOLDINGS</span> ({{userData.userSigel}})</h4>
</div>

<div class="modal-body holdings">
  <div data-cg-busy="{promise:promises.holding.loading, message:'Laddar bestånd...', minDuration: 800}"></div>
  <div data-cg-busy="{promise:promises.holding.saving, message:'Sparar bestånd...', minDuration: 800}"></div>
  
  <accordion class="other-holdings" ng-show="false">
    <accordion-group is-open="showOtherHoldings">
      <accordion-heading>
        Visa bestånd för andra bibliotek (beta) <i class="pull-right fa" ng-class="{'fa-chevron-down': showOtherHoldings, 'fa-chevron-right': !showOtherHoldings}"></i>
      </accordion-heading>
      <accordion close-others="true">
        <accordion-group data-ng-repeat="otherHolding in otherHoldings" is-open="offer.open">
          <accordion-heading>
              {{otherHolding.about.heldBy.notation}} <i class="pull-right fa" ng-class="{'fa-chevron-down': offer.open, 'fa-chevron-right': !offer.open}"></i>
          </accordion-heading>
          <div data-ng-repeat="offer in otherHolding.about.offers" class="other-offer">
            <span class="offer-value" data-ng-repeat="(property, value) in offer" data-ng-show="property != '@type' && property != 'open'&& property != 'heldBy'">{{property}}: {{value}}<span data-ng-show="!$last">, </span></span>
          </div>
        </accordion-group>
      </accordion>
    </accordion-group>
  </accordion>
  
  <h4>{{ utils.composeTitle(record) | chop:80}}, {{ utils.composeCreator(record) | chop:40 }} {{ utils.composeDate(publication.providerDate) }}</h4>

  <form data-ng-show="holding['@id'] || !holding['etag']" name="holdingForm">
    <section class="offer form-container" data-ng-repeat="offer in holding.about.offers track by $index">
      <div class="cols">
          <kitin-group title="Lokalsignum" initially-visible>
            <kitin-entityrow title-prefix="LABEL.holdings." model="offer.heldBy" multiple>
              <kitin-select options-model="userData"></kitin-select>
            </kitin-entityrow>

            <kitin-textrow title-prefix="LABEL.holdings." model="offer.shelfLocation" change-model="holding"></kitin-textrow>
            <kitin-textrow title-prefix="LABEL.holdings." model="offer.classificationPart" change-model="holding"></kitin-textrow>
            <kitin-textrow title-prefix="LABEL.holdings." model="offer.shelfControlNumber" change-model="holding"></kitin-textrow>
            <kitin-textrow title-prefix="LABEL.holdings." model="offer.shelfLabel" change-model="holding"></kitin-textrow>
            <kitin-textrow title-prefix="LABEL.holdings." model="offer.availability" change-model="holding"></kitin-textrow>
            <kitin-textrow title-prefix="LABEL.holdings." model="offer.copyNumber" change-model="holding"></kitin-textrow>
            <kitin-textrow title-prefix="LABEL.holdings." model="offer.copyNote" change-model="holding"></kitin-textrow>
            <kitin-textrow title-prefix="LABEL.holdings." model="offer.editorialNote" change-model="holding"></kitin-textrow>
          </kitin-group>

        <div class="col12">
          <button class="btn btn-link pull-right" data-ng-if="holding.about.offers.length > 1" data-ng-click="deleteOffer(holding, $index)"><i class="fa fa-trash-o"></i> {{ "Radera lokalsignum" }}</button>
        </div>
      </div>
    </section>
  </form>

  <hr data-ng-show="holding">

  <div class="alert alert-success" role="alert" data-ng-show="modifications.holding.deleted">
    {{ "Beståndet raderat" }}
  </div>
  
  <div class="alert alert-error" role="alert" data-ng-show="holding.about.offers.length < 1">
    {{ "Beståndet saknar lokalsignum" }}
  </div>

  <div class="modal-alerts" data-ng-show="alerts.length > 0">
    <alert data-ng-repeat="alert in alerts" type="{{alert.type}}" close="closeAlert($index)">{{alert.msg}}</alert>
  </div>

  <div>
    <button class="btn btn-flat btn-purple-light" data-ng-click="addOffer(holding)" data-ng-show="holding"><i class="fa fa-plus"></i> {{ "Lägg till lokalsignum" }}</button>
  </div>

</div>

<div class="modal-footer holdings submit">
  <div class="status pull-left">
    <div data-ng-if="modifications.holding.saved">{{ "Inga osparade ändringar." }}</div>
    <div data-ng-if="!modifications.holding.saved && !isNew">{{ "Du har inte sparat dina ändringar." }}</div>
    <div data-ng-if="!modifications.holding.saved && isNew">{{ "Nyskapat bestånd, inte sparat." }}</div>
  </div>
  <button class="btn-link" id="delete-hld" data-ng-click="deleteHolding(holding)" data-ng-show="holding['@id']"><i class="fa fa-trash-o"></i> {{ "Radera bestånd" }}</button>
  <button class="btn btn-purple btn-submit" data-ng-click="saveHolding(holding)" data-ng-show="holding" data-ng-disabled="modifications.holding.saved">
    <span data-ng-if="!modifications.holding.saved">{{ "Spara bestånd" }}</span>
    <span data-ng-if="modifications.holding.saved">{{ "Bestånd sparat" }} <i class="fa fa-check"></i></span>
  </button>
  <button class="btn btn-purple btn-submit" data-ng-click="close()" data-ng-show="!holding">{{ "Stäng" }}</button>
</div>